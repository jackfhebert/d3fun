<html>
  <head>
    <script src="./d3.v3.min.js" charset="utf-8"></script>
  </head>
  <body>
    <div id='main'></div>
    <div id='chart'></div>
  </body>
  <script type="text/javascript">
    var main = d3.select('#main')
        .text('Data in your data')
        .style('height', '50px')

var width = 800;
var height = 200;
var root = d3.select('#chart').append('div')
    .attr({
      'width': width,
      'height': height,
    })
    .style('border', '1px solid black');

var numRows = 10;
var maxDataValue = 10
var dataItems = [];
for (var i = 0; i < numRows; i++) {
  // For the nested data thing to work, the width needs to be
  // a list. This will eventually be more complicated than
  // than a single element list.
  var toAdd = {'name': '' + i,
               'width': [Math.random() * maxDataValue]}
  dataItems.push(toAdd);
}

COLORS = ['#556270', '#4Ecdc4', '#c7f4c4', '#ff6b6b', '#c44d58']
OTHER_COLORS = ['#c2412d', '#d1aa34', '#a7a844', '#a46583', '#5a1e4a']

var barHeight = height / numRows;
var barWidth = function(datum) {
  return datum * (width / maxDataValue);
};
var barX = 0;
var barY = function(datum, index) {
  return index * barHeight;
};
var getColor = function(datum, localIndex, parentIndex) {
  index = parentIndex % COLORS.length
  return COLORS[index]
};

// Make a div for each row. Want to have it start with
// text of the question name.
var rows = root.selectAll('div.row').data(dataItems).enter()
  .append('div')
    .classed({'row': true})
    .style('height', '25px')
rows.append('span')
    .text(function(rowData) { return rowData.name });

// Want each div to contain an SVG element that we can draw in.
var svgContainers = rows.append('svg')
    .attr({
      'width': 700,
      'height': barHeight + 5,
    });


// Add a rectangle of the correct lenght in each SVG element.
var bars = svgContainers.selectAll('rect.number')
    .data(function(d) { return d.width; }).enter()
    .append('rect')
    .attr({
      'class': 'number',
      'x': barX,
      'y': 3,
      'width': barWidth,
      'height': barHeight - 2,
      'fill': getColor,
      'stroke': '#444',
    });

  </script>
</html>
